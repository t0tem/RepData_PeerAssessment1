---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data

We're loading the data directly, without unzipping it

```{r}
activity <- read.csv(unz("activity.zip", "activity.csv"))
```

## What is mean total number of steps taken per day?

We're creating a new data frame with total amount of steps aggregated by date
and plotting a histogram of this data 

```{r}
total.by.date <- aggregate(steps ~ date, data = activity, sum)
hist(total.by.date$steps)
```

We can check out the mean and median of the total number of steps taken per day
by calculating some summary statistics of aggregated data frame

```{r}
summary(total.by.date$steps)
```

So the mean is 10770, and the median is 10760

## What is the average daily activity pattern?

To explore the average daily activity pattern we'll first load dplyr package

```{r message = FALSE}
library(dplyr)
```

now we can easily group data frame and calculate average number of steps taken per interval, averaged across all days

```{r}
aver.by.interv <- activity %>% group_by(interval) %>% summarise(steps = mean(steps, na.rm = TRUE))
```

and make a time series plot of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all days (y-axis) using ggplot2 package (we'll load it first)

```{r message = FALSE}
library(ggplot2)
ggplot(aver.by.interv, aes( x = interval, y = steps)) + geom_line()
```

we can see on the graph that the maximum number of steps happens in the interval somewhere between 7:50
(i.e. interval value = 750) and 10:00 (interval value = 1000)
for a precise calculation we'll use 'which.max' function subsetting our aggregated data frame 

```{r}
aver.by.interv[which.max(aver.by.interv$steps),]
```

so we see that the maximum average number of steps is 206.17 and it happens in the 5-minute interval beginning at 8:35

## Imputing missing values

To check the total number of missing values in the dataset we'll calculate some simple summary statistics

```{r}
summary(activity)
```

so we can see that 'steps' variable is the only one with missing values and there are 2304 of them

### *The strategy for filling in all of the missing values in the dataset*
We'll fill in missing values with the mean of its' 5-minute interval. To do that we'll use again 'group_by' from 
dplyr package together with 'mutate' and 'replace'. The result will be directly assigned to a new data frame 'activity.no.NA'

```{r}
activity.no.NA <- activity %>% 
      group_by(interval) %>%
      mutate(steps = replace(steps, is.na(steps), mean(steps, na.rm = TRUE))) %>%
      as.data.frame()

```

So now we can repeat the step of aggregating this new data frame by date with total number of steps
and plotting a histogram of this data 

```{r}
total.by.date.no.NA <- aggregate(steps ~ date, data = activity.no.NA, sum)
hist(total.by.date.no.NA$steps)
```

Let's calculate some summary statistics for the total number of steps taken each day
```{r}
summary(total.by.date.no.NA$steps)
```

recalling the initial result of dataset with missing values
```{r}
summary(total.by.date$steps)
```

As we can see our strategy of imputing missing values impacted the Median of dataset (changed from 10760 to 10770) but not the Mean (stayed equal 10770)


## Are there differences in activity patterns between weekdays and weekends?
